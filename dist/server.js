(()=>{var e={672:(e,t,n)=>{const o=n(860),r=n(582),s=n(665),{sendOTPConfirmEmail:i,sendTokenResetPassword:a,sendMailToRegisterSeller:l,sendMailOrderSuccess:c,sendMailActiveAccount:d}=n(392),{deleteFiles:p,moveDelete:m}=n(227),g=(n(76),n(556)),h=o(),{sendMail:u,sendOtp:f}=n(951);s.subscribe("send_mail","send_token","send_email_reset_password","send_otp_register_mobile","delete_file_list","order_success","send_noti_order","send_noti_delivery","move_image",((e,t)=>{e?console.error("Failed to subscribe: %s",e.message):console.log(`Subscribed successfully! This client is currently subscribed to ${t} channels.`)})),s.on("message",(async(e,t)=>{if(console.log(`Received data from ${e}`),"move_image"!==e){if("send_mail"===e){const e=JSON.parse(t);return console.log(e),"register_seller"===e.type?void u({sendTo:e.email,text:"Email to register seller account",subject:"Access the link to register seller account",html:l(e.verifyToken,e.name)}):void("register_user"===e.type&&u({sendTo:e.email,text:"Email to active your account",subject:"Access the link to active your account",html:d({token:e.verifyToken,name:e.name})}))}if("send_email_reset_password"!==e)if("send_otp_register_mobile"!==e){if("delete_file_list"===e){const e=JSON.parse(t);return console.log(e),void p(e.fileList)}if("order_success"===e){const e=JSON.parse(t);u({sendTo:e.email,text:"Email to announce you order",subject:"Please check your order",html:c({name:e.name,orderId:e.orderId,totalPaid:e.totalPaid,totalShippingCost:e.totalShippingCost})}),console.log(e)}if("send_noti_order"===e){const e=JSON.parse(t);console.log(e),global.users[e.user]?.forEach((t=>{global._io.sockets.to(t).emit(g.send_noti_confirm_order,{title:e.title,content:e.content,type:e.type})}))}if("send_noti_delivery"===e){const e=JSON.parse(t);console.log(e),global.users[e.user]?.forEach((t=>{global._io.sockets.to(t).emit(g.send_noti_confirm_shipping,{title:e.title,content:e.content,type:e.type})}))}}else{const e=JSON.parse(t);f(e.email,e.name,e.otp,"The OTP code active your account",i)}else{const e=JSON.parse(t);f(e.email,e.name,e.token,"The Link Reset Password",a)}}else{const e=JSON.parse(t),{filePath:n,userId:o}=e;m({filePath:n,userId:o})}})),h.use(o.json()),h.use(o.urlencoded({extended:!0})),h.use("/images",o.static("src/public/images")),h.use("/proof",o.static("src/public/proof")),h.use("/temp",o.static("src/public/temp")),h.use(r()),h.use(n(203)),h.use(((e,t,n)=>{const o=new Error("Not found");o.status=404,n(o)})),h.use(((e,t,n,o)=>{n.status(e.status||500).send({error:{status:e.status||500,message:e.message||"Internal Server Error"}})})),e.exports=h},412:(e,t,n)=>{const{deleteFile:o,deleteFileListImage:r,deleteFileListProof:s,moveDelete:i}=n(227);e.exports={uploadFile:async(e,t)=>(console.log(e.file),t.status(201).json({status:"done",uid:e.file.filename,url:process.env.SERVER_HOST_TEMP+e.payload.userId+"/"+e.file.filename})),uploadProofSeller:async(e,t)=>e.files?(console.log(e.files),t.status(200).json({status:"done",uid:e.files[0].filename,url:process.env.SERVER_HOST_TEMP+e.payload.userId+"/"+e.files[0].filename})):t.status(404).json("Do not receive any file"),delete:(e,t)=>{const{image:n,type:r}=e.body;return t.status(200).json(o({file:n.split("/").at(-1),typeFolder:r}))},deleteListImage:async(e,t)=>{const{files:n}=e.body;try{const e=await r(n);return t.status(e.status).json(e)}catch(e){return t.status(e.payload).json(e)}},deleteFileListProof:async(e,t)=>{const{files:n}=e.body;try{const e=await s(n);return t.status(e.status).json(e)}catch(e){return t.status(e.payload).json(e)}},moveFile:async(e,t)=>{const{path:n,type:o}=e.body;try{const r=await i({filePath:n,userId:e.payload.userId,type:o});return t.status(200).json(r)}catch(e){return console.log(e),t.status(500).json(e)}}}},665:(e,t,n)=>{const o=new(n(495))({port:process.env.REDIS_PORT,host:process.env.REDIS_HOST,username:process.env.REDIS_USERNAME,password:process.env.REDIS_PASSWORD});o.ping((function(e,t){console.log(t)})),o.on("connect",(()=>{console.log("Redis client connected")})),o.on("error",(e=>{console.error(e)})),e.exports=o},393:e=>{e.exports={format_file_invalid:"Only images are allowed",format_file_and_image_invalid:"Only images and file ex: dox, pdf"}},556:e=>{e.exports={send_noti_confirm_order:"send-noti-confirm-order",noti_confirm_order_success:"noti-confirm-order-success",send_noti_delivery_order:"send-noti-delivery-order",noti_delivery_order:"noti-delivery-order",send_noti_confirm_shipping:"send-noti-confirm-shipping"}},812:(e,t,n)=>{const o=n(738),r=n(17),s=(n(393),n(31)),i=n(147);e.exports={uploadSingle:o({storage:o.diskStorage({destination:(e,t,n)=>{console.log(e.payload);const o=`src/public/temp/${e.payload.userId}`;i.mkdirSync(o,{recursive:!0}),n(null,o)},filename:(e,t,n)=>{n(null,Date.now()+"-"+s()+r.extname(t.originalname))}}),limits:{fileSize:Number(process.env.IMAGE_MAX_SIZE||524288)}}).single("file"),uploadMultiple:o({storage:o.diskStorage({destination:function(e,t,n){const o=`src/public/temp/${e.payload.userId}`;i.mkdirSync(o,{recursive:!0}),n(null,o)},filename:function(e,t,n){n(null,t.fieldname+"_"+Date.now()+"_"+t.originalname)}}),limits:{fileSize:5242880}}).array("proof",5)}},203:(e,t,n)=>{const o=n(860).Router(),r=n(412),{verifyAccessToken:s}=n(834),{uploadSingle:i,uploadMultiple:a}=n(812);o.get("/checkstatus",(async(e,t)=>{t.status(200).json({status:"success",message:"api ok"})})),o.post("/api/upload/image",s,i,r.uploadFile),o.post("/api/upload/image-user",i,r.uploadFile),o.post("/api/upload/proof",s,a,r.uploadProofSeller),o.post("/api/delete/image",r.delete),o.post("/api/delete/image/list",r.deleteListImage),o.post("/api/delete/proof/list",r.deleteFileListProof),o.post("/api/upload/save",s,r.moveFile),e.exports=o},834:(e,t,n)=>{const o=n(344),r=n(931),s=n(665);n(142).config(),e.exports={signAccessToken:async(e,t,n)=>new Promise(((r,s)=>{const i=e,a={expiresIn:n||"1d"};o.sign(i,t,a,((e,t)=>e?s(e):r(t)))})),verifyAccessToken:(e,t,n)=>{const s=e.headers.authorization,{login:i}=e.query,a="true"===i?process.env.ACCESS_TOKEN_SECRET:process.env.IMAGE_TOKEN_SECRET;o.verify(s.trim(),a,((t,o)=>{if(t)return console.log(t),"JsonWebTokenError"===t.name?n(r.Unauthorized()):n(r.Unauthorized(t.message));e.payload=o,console.log("check:::"),n()}))},signRefreshToken:async e=>new Promise(((t,n)=>{const r={userId:e},i=process.env.REFRESH_TOKEN_SECRET;o.sign(r,i,{expiresIn:"10m"},((e,o)=>e?n(e):(s.set(o,r.userId.toString(),"EX",60).then((e=>{console.log("data:::",e)})),console.log("token:::",o),t(o))))})),verifyRefreshToken:async(e,t)=>new Promise((async(n,r)=>{const i=await s.get(t);if(e!==i)return r("token is expired, pls login again");o.verify(t,process.env.REFRESH_TOKEN_SECRET,((e,t)=>e?r(e):n(t)))}))}},951:(e,t,n)=>{const{google:o}=n(993),r=n(184);n(142).config();const s=process.env.CLIENT_ID_EMAIL,i=process.env.CLIENT_SECRET_EMAIL,a=process.env.REDIRECT_URI_EMAIL,l=process.env.REFRESH_TOKEN_EMAIL,c=new o.auth.OAuth2(s,i,a);c.setCredentials({refresh_token:l}),e.exports={sendMail:async({sendTo:e,text:t,subject:n,html:o})=>{try{const a=await c.getAccessToken(),d=r.createTransport({service:"gmail",auth:{type:"OAUTH2",user:process.env.USERNAME_EMAIL||"baotrue123@gmail.com",clientId:s,clientSecret:i,refreshToken:l,accessToken:a}});let p=await d.sendMail({from:`Book Ecommerce ðŸ‘»<${process.env.USERNAME_EMAIL||"baotrue123@gmail.com"}>`,to:e,subject:n,text:t,html:o});console.log(p)}catch(e){console.error(e)}},sendOtp:async(e,t,n,o,a)=>{try{const d=await c.getAccessToken(),p=r.createTransport({service:"gmail",auth:{type:"OAUTH2",user:process.env.USERNAME_EMAIL||"baotrue123@gmail.com",clientId:s,clientSecret:i,refreshToken:l,accessToken:d}});let m=await p.sendMail({from:`Book Ecommerce ðŸ‘»<${process.env.USERNAME_EMAIL||"baotrue123@gmail.com"}>`,to:e,subject:o||"Please enter the otp code to reset password",text:"Your OTP code",html:a(n,t)});console.log(m)}catch(e){console.error(e)}}}},227:(e,t,n)=>{const{rimraf:o}=n(76),r=n(147),s=n(470);e.exports={deleteFile:async({file:e,typeFolder:t})=>{if("images"===t){const t="src/public/images/";r.mkdirSync(t,{recursive:!0}),o(t+e).then((e=>(console.log(e),e))).catch((e=>(console.log(e),e)))}if("proof"===t){const t="src/public/proof/";r.mkdirSync(t,{recursive:!0}),o(t+e).then((e=>(console.log(e),e))).catch((e=>(console.log(e),e)))}},deleteFileListImage:async e=>new Promise(((t,n)=>{const s="src/public/images/";r.mkdirSync(s,{recursive:!0});try{Promise.all(e.map((e=>o(s+e.split("/").at(-1))))).then((e=>t({status:200,data:e}))).catch((e=>n({status:500,message:"INTERNAL SERVER ERROR"})))}catch(e){return n({status:500,message:"INTERNAL SERVER ERROR"})}})),deleteFileListProof:async e=>new Promise(((t,n)=>{const s="src/public/proof/";r.mkdirSync(s,{recursive:!0});try{Promise.all(e.map((e=>o(s+e.split("/").at(-1))))).then((e=>t({status:200,data:e}))).catch((e=>n({status:500,message:"INTERNAL SERVER ERROR"})))}catch(e){return n({status:500,message:"INTERNAL SERVER ERROR"})}})),moveDelete:async({filePath:e,userId:t,type:n="images"})=>new Promise(((t,o)=>{const r=process.env.DIRECTORY_TEMP+e,i="images"===n?process.env.DIRECTORY_IMAGE+e:process.env.DIRECTORY_PROOF+e;s.move(r,i).then((()=>t(!0))).catch((e=>o(e)))}))}},366:(e,t,n)=>{const{removeUser:o,pushSocketIdToArray:r,removeSocketIdFromArray:s}=n(899),i=n(805);e.exports=e=>{global.users=r(global.users,e.payload._id,e.id),i(e,global.users),console.log(global.users),e.on("disconnect",(()=>{global.users=s(global.users,e.payload._id,e.id),console.log(global.users)}))}},805:(e,t,n)=>{const{emitNotifyToArray:o}=n(899),r=n(556);e.exports=(e,t)=>{e.emit("test",t),e.on(r.send_noti_delivery_order,(n=>{const{userId:s,title:i,content:a,orderId:l}=n;o(t,s,e,r.noti_delivery_order,{status:200,type:"delivery",data:{title:i,content:a,orderId:l}})}))}},392:(e,t,n)=>{n(142).config(),e.exports={sendOTPConfirmEmail:(e,t="there")=>`\n  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n  <html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">\n      <head>\n          <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>\n          <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>\n          <meta http-equiv="X-UA-Compatible" content="IE=edge"/>\n          <meta name="format-detection" content="date=no"/>\n          <meta name="format-detection" content="address=no"/>\n          <meta name="format-detection" content="telephone=no"/>\n          <meta name="x-apple-disable-message-reformatting"/>\n  \n          <link rel="preconnect" href="https://fonts.googleapis.com">\n          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>\n          <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">\n  \n          <title>OTP Confirm Email</title>\n      </head>\n  \n      <body style="margin: 0; padding: 0; font-family: 'Manrope', sans-serif; min-height: 100vh; background: #EBFAFA;">\n          <center>\n              <table width="100%" border="0" cellspacing="0" cellpadding="0" style="background: #EBFAFA;">\n                  <tr>\n                      <td align="center">\n                          <table width="690" border="0" cellspacing="0" cellpadding="0">\n                              <tr>\n                                  <td style="padding: 35px">\n                                      <table width="100%" border="0" cellspacing="0" cellpadding="0">\n                                          <tr>\n                                              <td style="text-align:center; padding: 42px 15px 16px;">\n                                                  <a href="#" target="_blank">\n                                                      <img src="https://yoda.hypeople.studio/yoda-email-template/images/logo/logo-fill.svg" border="0" alt="Logo"/>\n                                                  </a>\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="font-size:20px; line-height:24px; font-weight: bold; color:#2D3436; min-width:auto !important; text-align:center; letter-spacing: -0.02em; padding-bottom: 42px;">\n                                                  BTN Ecommerce\n                                                  <br/>\n                                                  OTP Confirm Email\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="border-radius: 8px;" bgcolor="#ffffff">\n                                                  <table width="100%" border="0" cellspacing="0" cellpadding="0">\n                                                      <tr>\n                                                          <td style="font-size:14px; color:#0010F7; min-width:auto !important; padding: 32px;">\n                                                             Confirm Your E-Mail Address ðŸ“®\n                                                          </td>\n                                                      </tr>\n  \n                                                      <tr>\n                                                          <td style="font-size:14px; color:#636E72; min-width:auto !important; line-height: 20px; padding: 0 32px 32px;">\n                                                              Hi ${t},\n                                                              <br/>\n                                                              <br/>\n                                                              Welcome!\n                                                              <br/>\n                                                              You are receiving this email because you have registered on our site.\n                                                              <br/>\n                                                              <br/>\n                                                              Enter the OTP code below to active your account.\n                                                              <br/>\n                                                              <br/>\n                                                              This OTP code will expire in 60 minutes and can only be used once.\n                                                              <br/>\n                                                              <span target="_blank" style="color:#ffffff; background: #0010F7; border: 1px solid #0010F7; border-radius:8px; display: inline-block; margin-top: 8px; padding: 12px 22px; text-decoration:none;">\n                                                                  ${e}\n                                                              </span>\n                                                          </td>\n                                                      </tr>\n  \n                                                      <tr>\n                                                          <td style="font-size:14px; color:#636E72; min-width:auto !important; line-height: 20px; padding: 0 32px 32px;">\n                                                              OR\n                                                              <br/>\n                                                              If the otp code above does not work, please contact to our admin:\n                                                              <br/>\n                                                              <br/>\n                                                              This is an automatically generated email please do not reply to this email. If you face any issues, please contact us at <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2c4449405c6c5543484d024f4341">[email&#160;protected]</a>\n                                                          </td>\n                                                      </tr>\n                                                  </table>\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="font-size:12px; color:#B2BEC3; min-width:auto !important; line-height: 12px; text-align:center; padding-top: 42px;">\n                                                  Copyright Â© 2022\n                                                  BTN Ecommerce\n                                                  All rights reserved.\n                                              </td>\n                                          </tr>\n                                      </table>\n                                  </td>\n                              </tr>\n                          </table>\n                      </td>\n                  </tr>\n              </table>\n          </center>\n      <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"><\/script></body>\n  </html>\n  `,sendTokenResetPassword:(e,t="there")=>`\n  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n  <html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">\n      <head>\n          <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>\n          <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>\n          <meta http-equiv="X-UA-Compatible" content="IE=edge"/>\n          <meta name="format-detection" content="date=no"/>\n          <meta name="format-detection" content="address=no"/>\n          <meta name="format-detection" content="telephone=no"/>\n          <meta name="x-apple-disable-message-reformatting"/>\n  \n          <link rel="preconnect" href="https://fonts.googleapis.com">\n          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>\n          <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">\n  \n          <title>Reset Password</title>\n      </head>\n  \n      <body style="margin: 0; padding: 0; font-family: 'Manrope', sans-serif; min-height: 100vh; background: #EBFAFA;">\n          <center>\n              <table width="100%" border="0" cellspacing="0" cellpadding="0" style="background: #EBFAFA;">\n                  <tr>\n                      <td align="center">\n                          <table width="690" border="0" cellspacing="0" cellpadding="0">\n                              <tr>\n                                  <td style="padding: 35px">\n                                      <table width="100%" border="0" cellspacing="0" cellpadding="0">\n                                          <tr>\n                                              <td style="text-align:center; padding: 42px 15px 16px;">\n                                                  <a href="#" target="_blank">\n                                                      <img src="https://yoda.hypeople.studio/yoda-email-template/images/logo/logo-fill.svg" border="0" alt="Logo"/>\n                                                  </a>\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="font-size:20px; line-height:24px; font-weight: bold; color:#2D3436; min-width:auto !important; text-align:center; letter-spacing: -0.02em; padding-bottom: 42px;">\n                                                  Book Ecommerce\n                                                  <br/>\n                                                  Reset Password\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="border-radius: 8px;" bgcolor="#ffffff">\n                                                  <table width="100%" border="0" cellspacing="0" cellpadding="0">\n                                                      <tr>\n                                                          <td style="font-size:14px; color:#0010F7; min-width:auto !important; padding: 32px;">\n                                                             Confirm Your E-Mail Address ðŸ“®\n                                                          </td>\n                                                      </tr>\n  \n                                                      <tr>\n                                                          <td style="font-size:14px; color:#636E72; min-width:auto !important; line-height: 20px; padding: 0 32px 32px;">\n                                                              Hi ${t},\n                                                              <br/>\n                                                              <br/>\n                                                              Welcome!\n                                                              <br/>\n                                                              You are receiving this email because you have forgot password on our site.\n                                                              <br/>\n                                                              <br/>\n                                                              Enter the link below to reset password.\n                                                              <br/>\n                                                              <br/>\n                                                              This OTP code will expire in 24 hours and can only be used once.\n                                                              <br/>\n                                                              <a href="${process.env.LINK_RESET_PASSWORD+e}" target="_blank" style="color:#ffffff; background: #0010F7; border: 1px solid #0010F7; border-radius:8px; display: inline-block; margin-top: 8px; padding: 12px 22px; text-decoration:none;">\n                                                                  Reset password\n                                                              </a>\n                                                          </td>\n                                                      </tr>\n  \n                                                      <tr>\n                                                          <td style="font-size:14px; color:#636E72; min-width:auto !important; line-height: 20px; padding: 0 32px 32px;">\n                                                              OR\n                                                              <br/>\n                                                              If the link above does not work, please contact to our admin:\n                                                              <br/>\n                                                              <br/>\n                                                              This is an automatically generated email please do not reply to this email. If you face any issues, please contact us at <p>baotrandinh100@gmail.com</p>\n                                                          </td>\n                                                      </tr>\n                                                  </table>\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="font-size:12px; color:#B2BEC3; min-width:auto !important; line-height: 12px; text-align:center; padding-top: 42px;">\n                                                  Copyright Â© 2023\n                                                  Book Ecommerce\n                                                  All rights reserved.\n                                              </td>\n                                          </tr>\n                                      </table>\n                                  </td>\n                              </tr>\n                          </table>\n                      </td>\n                  </tr>\n              </table>\n          </center>\n  </html>\n  `,sendMailToRegisterSeller:(e,t="there")=>`\n  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n  <html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">\n      <head>\n          <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>\n          <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>\n          <meta http-equiv="X-UA-Compatible" content="IE=edge"/>\n          <meta name="format-detection" content="date=no"/>\n          <meta name="format-detection" content="address=no"/>\n          <meta name="format-detection" content="telephone=no"/>\n          <meta name="x-apple-disable-message-reformatting"/>\n  \n          <link rel="preconnect" href="https://fonts.googleapis.com">\n          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>\n          <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">\n  \n          <title>Register Seller Account</title>\n      <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=I3mBEEJKbb_1RGnCEKNd1gGcjtnRDacDtcyFqvlth9rhixACpHZoQdnuZF8R57kgDi_5iPizTl94QOkPeI-vilvt0Mqg5U_ePqKLDIuUPe8" charset="UTF-8"><\/script></head>\n  \n      <body style="margin: 0; padding: 0; font-family: 'Manrope', sans-serif; min-height: 100vh; background: #EBFAFA;">\n          <center>\n              <table width="100%" border="0" cellspacing="0" cellpadding="0" style="background: #EBFAFA;">\n                  <tr>\n                      <td align="center">\n                          <table width="690" border="0" cellspacing="0" cellpadding="0">\n                              <tr>\n                                  <td style="padding: 35px">\n                                      <table width="100%" border="0" cellspacing="0" cellpadding="0">\n                                          <tr>\n                                              <td style="text-align:center; padding: 42px 15px 16px;">\n                                                  <a href="#" target="_blank">\n                                                      <img src="https://yoda.hypeople.studio/yoda-email-template/images/logo/logo-fill.svg" border="0" alt="Logo"/>\n                                                  </a>\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="font-size:20px; line-height:24px; font-weight: bold; color:#2D3436; min-width:auto !important; text-align:center; letter-spacing: -0.02em; padding-bottom: 42px;">\n                                                  Modern & Minimalistic\n                                                  <br/>\n                                                  Email Template\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="border-radius: 8px;" bgcolor="#ffffff">\n                                                  <table width="100%" border="0" cellspacing="0" cellpadding="0">\n                                                      <tr>\n                                                          <td style="font-size:24px; color:#0010F7; min-width:auto !important; font-weight: bold; padding: 32px 32px 0;">\n                                                             Please access the link to register seller account ðŸ“®\n                                                          </td>\n                                                      </tr>\n  \n                                                      <tr>\n                                                          <td style="font-size:14px; color:#636E72; min-width:auto !important; line-height: 20px; padding: 32px;">\n                                                              Hi ${t},\n                                                              <br/>\n                                                              <br/>\n                                                              Welcome!\n                                                              <br/>\n                                                              You are receiving this email because you have registered on our site.\n                                                              <br/>\n                                                              <br/>\n                                                              Click the link below to sign up your seller account.\n                                                              <br/>\n                                                              <br/>\n                                                              This link will expire in 24h and can only be used once.\n                                                              <br/>\n                                                              <a href="${process.env.LINK_REGISTER_SELLER+e}" target="_blank" style="color:#ffffff; background: #0010F7; border: 1px solid #0010F7; border-radius:8px; display: inline-block; margin-top: 8px; padding: 12px 22px; text-decoration:none;">\n                                                                  Register Seller\n                                                              </a>\n                                                          </td>\n                                                      </tr>\n  \n                                                      <tr>\n                                                          <td style="font-size:14px; color:#636E72; min-width:auto !important; line-height: 20px; padding: 0 32px 32px;">\n                                                              OR\n                                                              <br/>\n                                                              If the button above does not work, paste this link into your web browser:\n                                                              <br/>\n                                                              <br/>\n                                                              <a href="#" target="_black" style="text-decoration: none; color: #0010F7;">${process.env.LINK_REGISTER_SELLER+e}</a>\n                                                              <br/>\n                                                              If you did not make this request, please contact us or ignore this message.\n                                                              <br/>\n                                                              <br/>\n                                                              This is an automatically generated email please do not reply to this email. If you face any issues, please contact us at baotrandinh100@gmail.com\n                                                          </td>\n                                                      </tr>\n                                                  </table>\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="font-size:12px; color:#B2BEC3; min-width:auto !important; line-height: 12px; text-align:center; padding-top: 42px;">\n                                                  Copyright Â© 2022\n                                                  <a href="${process.env.LINK_ADMIN_WEB_PAGE}" target="_blank" style="text-decoration:none; color:#0010F7;">BTN Ecommerce</a>\n                                                  All rights reserved.\n                                              </td>\n                                          </tr>\n                                      </table>\n                                  </td>\n                              </tr>\n                          </table>\n                      </td>\n                  </tr>\n              </table>\n          </center>\n      <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"><\/script></body>\n  </html>\n  `,sendMailOrderSuccess:({name:e,orderId:t,totalPaid:n,totalShippingCost:o})=>`\n  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n  <html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">\n      <head>\n          <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>\n          <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>\n          <meta http-equiv="X-UA-Compatible" content="IE=edge"/>\n          <meta name="format-detection" content="date=no"/>\n          <meta name="format-detection" content="address=no"/>\n          <meta name="format-detection" content="telephone=no"/>\n          <meta name="x-apple-disable-message-reformatting"/>\n  \n          <link rel="preconnect" href="https://fonts.googleapis.com">\n          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>\n          <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">\n  \n          <title>You are ordered successfully</title>\n      <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=I3mBEEJKbb_1RGnCEKNd1gGcjtnRDacDtcyFqvlth9rhixACpHZoQdnuZF8R57kgDi_5iPizTl94QOkPeI-vilvt0Mqg5U_ePqKLDIuUPe8" charset="UTF-8"><\/script></head>\n  \n      <body style="margin: 0; padding: 0; font-family: 'Manrope', sans-serif; min-height: 100vh; background: #EBFAFA;">\n          <center>\n              <table width="100%" border="0" cellspacing="0" cellpadding="0" style="background: #EBFAFA;">\n                  <tr>\n                      <td align="center">\n                          <table width="690" border="0" cellspacing="0" cellpadding="0">\n                              <tr>\n                                  <td style="padding: 35px">\n                                      <table width="100%" border="0" cellspacing="0" cellpadding="0">\n                                          <tr>\n                                              <td style="text-align:center; padding: 42px 15px 16px;">\n                                                  <a href="#" target="_blank">\n                                                      <img src="https://yoda.hypeople.studio/yoda-email-template/images/logo/logo-fill.svg" border="0" alt="Logo"/>\n                                                  </a>\n                                              </td>\n                                          </tr>\n  \n  \n                                          <tr>\n                                              <td style="border-radius: 8px;" bgcolor="#ffffff">\n                                                  <table width="100%" border="0" cellspacing="0" cellpadding="0">\n                                                      <tr>\n                                                          <td style="font-size:24px; color:#0010F7; min-width:auto !important; font-weight: bold; padding: 32px 32px 0;">\n                                                             Please check your order ðŸ“®\n                                                          </td>\n                                                      </tr>\n  \n                                                      <tr>\n                                                          <td style="font-size:14px; color:#636E72; min-width:auto !important; line-height: 20px; padding: 32px;">\n                                                              Hi ${e},\n                                                              <br/>\n                                                              <br/>\n                                                              Welcome!\n                                                              <br/>\n                                                              Your orderID: ${t}.\n                                                              <br/>\n                                                              <br/>\n                                                              Total Paid: ${n}.\n                                                              <br/>\n                                                              <br/>\n                                                              Total Shipping Cost: ${o}.\n                                                              <br/>\n                                                          </td>\n                                                      </tr>\n  \n                                                      <tr>\n                                                          <td style="font-size:14px; color:#636E72; min-width:auto !important; line-height: 20px; padding: 0 32px 32px;">\n                                       \n                                                              This is an automatically generated email please do not reply to this email. If you face any issues, please contact us at baotrandinh100@gmail.com\n                                                          </td>\n                                                      </tr>\n                                                  </table>\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="font-size:12px; color:#B2BEC3; min-width:auto !important; line-height: 12px; text-align:center; padding-top: 42px;">\n                                                  Copyright Â© 2022\n                                                  <a href="${process.env.LINK_ADMIN_WEB_PAGE}" target="_blank" style="text-decoration:none; color:#0010F7;">BTN Ecommerce</a>\n                                                  All rights reserved.\n                                              </td>\n                                          </tr>\n                                      </table>\n                                  </td>\n                              </tr>\n                          </table>\n                      </td>\n                  </tr>\n              </table>\n          </center>\n      <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"><\/script></body>\n  </html>\n  `,sendMailActiveAccount:({token:e,name:t})=>`\n  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n  <html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">\n      <head>\n          <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>\n          <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>\n          <meta http-equiv="X-UA-Compatible" content="IE=edge"/>\n          <meta name="format-detection" content="date=no"/>\n          <meta name="format-detection" content="address=no"/>\n          <meta name="format-detection" content="telephone=no"/>\n          <meta name="x-apple-disable-message-reformatting"/>\n  \n          <link rel="preconnect" href="https://fonts.googleapis.com">\n          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>\n          <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">\n  \n          <title>Active Account</title>\n      <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=I3mBEEJKbb_1RGnCEKNd1gGcjtnRDacDtcyFqvlth9rhixACpHZoQdnuZF8R57kgDi_5iPizTl94QOkPeI-vilvt0Mqg5U_ePqKLDIuUPe8" charset="UTF-8"><\/script></head>\n  \n      <body style="margin: 0; padding: 0; font-family: 'Manrope', sans-serif; min-height: 100vh; background: #EBFAFA;">\n          <center>\n              <table width="100%" border="0" cellspacing="0" cellpadding="0" style="background: #EBFAFA;">\n                  <tr>\n                      <td align="center">\n                          <table width="690" border="0" cellspacing="0" cellpadding="0">\n                              <tr>\n                                  <td style="padding: 35px">\n                                      <table width="100%" border="0" cellspacing="0" cellpadding="0">\n                                          <tr>\n                                              <td style="text-align:center; padding: 42px 15px 16px;">\n                                                  <a href="#" target="_blank">\n                                                      <img src="https://yoda.hypeople.studio/yoda-email-template/images/logo/logo-fill.svg" border="0" alt="Logo"/>\n                                                  </a>\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="font-size:20px; line-height:24px; font-weight: bold; color:#2D3436; min-width:auto !important; text-align:center; letter-spacing: -0.02em; padding-bottom: 42px;">\n                                                  <br/>\n                                                  Confirmation Email\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="border-radius: 8px;" bgcolor="#ffffff">\n                                                  <table width="100%" border="0" cellspacing="0" cellpadding="0">\n                                                      <tr>\n                                                          <td style="font-size:24px; color:#0010F7; min-width:auto !important; font-weight: bold; padding: 32px 32px 0;">\n                                                             Please access the link to active account ðŸ“®\n                                                          </td>\n                                                      </tr>\n  \n                                                      <tr>\n                                                          <td style="font-size:14px; color:#636E72; min-width:auto !important; line-height: 20px; padding: 32px;">\n                                                              Hi ${t},\n                                                              <br/>\n                                                              <br/>\n                                                              Welcome!\n                                                              <br/>\n                                                              You are receiving this email because you have registered on our site.\n                                                              <br/>\n                                                              <br/>\n                                                              Click the link below to be active your account.\n                                                              <br/>\n                                                              <br/>\n                                                              This link will expire in 24h and can only be used once.\n                                                              <br/>\n                                                              <a href="${process.env.LINK_ACTIVE_USER+e}" target="_blank" style="color:#ffffff; background: #0010F7; border: 1px solid #0010F7; border-radius:8px; display: inline-block; margin-top: 8px; padding: 12px 22px; text-decoration:none;">\n                                                                  Active account\n                                                              </a>\n                                                          </td>\n                                                      </tr>\n  \n                                                      <tr>\n                                                          <td style="font-size:14px; color:#636E72; min-width:auto !important; line-height: 20px; padding: 0 32px 32px;">\n                                                              OR\n                                                              <br/>\n                                                              If the button above does not work, paste this link into your web browser:\n                                                              <br/>\n                                                              <br/>\n                                                              <a href="#" target="_black" style="text-decoration: none; color: #0010F7;">${process.env.LINK_REGISTER_SELLER+e}</a>\n                                                              <br/>\n                                                              If you did not make this request, please contact us or ignore this message.\n                                                              <br/>\n                                                              <br/>\n                                                              This is an automatically generated email please do not reply to this email. If you face any issues, please contact us at baotrandinh100@gmail.com\n                                                          </td>\n                                                      </tr>\n                                                  </table>\n                                              </td>\n                                          </tr>\n  \n                                          <tr>\n                                              <td style="font-size:12px; color:#B2BEC3; min-width:auto !important; line-height: 12px; text-align:center; padding-top: 42px;">\n                                                  Copyright Â© 2022\n                                                  <a href="${process.env.LINK_ADMIN_WEB_PAGE}" target="_blank" style="text-decoration:none; color:#0010F7;">BTN Ecommerce</a>\n                                                  All rights reserved.\n                                              </td>\n                                          </tr>\n                                      </table>\n                                  </td>\n                              </tr>\n                          </table>\n                      </td>\n                  </tr>\n              </table>\n          </center>\n      <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"><\/script></body>\n  </html>\n  `}},899:e=>{e.exports={getCurrentUser:(e,t)=>t.find((t=>t.id===e)),removeUser:(e,t,n)=>{const o=n[e]?.filter((e=>t!==e));return{...n,userId:o}},pushSocketIdToArray:(e,t,n)=>(e[t]?e[t].push(n):e[t]=[n],e),emitNotifyToArray:(e,t,n,o,r)=>{e[t]&&e[t].forEach((e=>{n.connected[e].emit(o,r)}))},removeSocketIdFromArray:(e,t,n)=>(e[t]&&(e[t]=e[t].filter((e=>e!==n)),e[t].length&&delete e[t]),e)}},582:e=>{"use strict";e.exports=require("cors")},142:e=>{"use strict";e.exports=require("dotenv")},860:e=>{"use strict";e.exports=require("express")},470:e=>{"use strict";e.exports=require("fs-extra")},993:e=>{"use strict";e.exports=require("googleapis")},931:e=>{"use strict";e.exports=require("http-errors")},495:e=>{"use strict";e.exports=require("ioredis")},344:e=>{"use strict";e.exports=require("jsonwebtoken")},738:e=>{"use strict";e.exports=require("multer")},184:e=>{"use strict";e.exports=require("nodemailer")},76:e=>{"use strict";e.exports=require("rimraf")},31:e=>{"use strict";e.exports=require("shortid")},952:e=>{"use strict";e.exports=require("socket.io")},147:e=>{"use strict";e.exports=require("fs")},685:e=>{"use strict";e.exports=require("http")},17:e=>{"use strict";e.exports=require("path")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}(()=>{n(142).config();const e=n(672),t=n(685).Server(e),o=n(952)(t,{cors:{origin:"*"}}),r=n(366),s=n(344),{PORT:i}=process.env,a=n(931);global._io=o,global.users={},global._io.use(((e,t)=>{const{token:n}=e.handshake.headers;if(console.log("token:::",n),!n)return t(new Error("please login!"));{const o=n.slice(7,n.length);s.verify(o,process.env.ACCESS_TOKEN_SECRET,((n,o)=>n?(console.log(n),n.name,t(new Error(a.Unauthorized().message))):(e.payload=o,t())))}})),global._io.on("connection",r),t.listen(i,(()=>{console.log(`WSV start with port ${i}`)}))})()})();